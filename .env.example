# Environment Configuration
# Copy this file to .env and update with your values

# ============================================================================
# APPLICATION
# ============================================================================
ENV=development  # development, staging, production
DEBUG=true
LOG_LEVEL=INFO
SECRET_KEY=your-secret-key-change-this-in-production
API_VERSION=v2
CORS_ORIGINS=http://localhost:3000,http://localhost:3001

# ============================================================================
# DATABASE
# ============================================================================
# PostgreSQL (Operational Database)
DATABASE_URL=postgresql+asyncpg://mbi_user:mbi_password@localhost:5432/mbi_db
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=40

# BigQuery (Data Warehouse) - Optional for MVP
BIGQUERY_PROJECT_ID=your-gcp-project-id
BIGQUERY_DATASET_RAW=MBI_raw
BIGQUERY_DATASET_CORE=MBI_core
BIGQUERY_DATASET_MARTS=MBI_marts
GOOGLE_APPLICATION_CREDENTIALS=./config/gcp-credentials.json

# ============================================================================
# REDIS
# ============================================================================
REDIS_URL=redis://localhost:6379/0
REDIS_MAX_CONNECTIONS=50
REDIS_SOCKET_TIMEOUT=5
REDIS_SOCKET_CONNECT_TIMEOUT=5

# Feature Store Redis (separate DB)
REDIS_FEATURE_STORE_URL=redis://localhost:6379/1

# ============================================================================
# MESSAGE BROKER
# ============================================================================
# Kafka / Redpanda
KAFKA_BOOTSTRAP_SERVERS=localhost:9092
KAFKA_CONSUMER_GROUP=mbi-consumers
KAFKA_AUTO_OFFSET_RESET=earliest

# Topics
KAFKA_TOPIC_SPEND_INGESTED=spend-ingested
KAFKA_TOPIC_ORDER_COMPLETED=order-completed
KAFKA_TOPIC_SESSION_TRACKED=session-tracked
KAFKA_TOPIC_CRISIS_DETECTED=crisis-detected
KAFKA_TOPIC_LEAD_SCORED=lead-scored

# ============================================================================
# LLM PROVIDERS
# ============================================================================
# Anthropic Claude
ANTHROPIC_API_KEY=sk-ant-your-api-key-here
ANTHROPIC_DEFAULT_MODEL=claude-sonnet-4-20250514
ANTHROPIC_MAX_TOKENS=2000
ANTHROPIC_TEMPERATURE=0.2

# OpenAI GPT (Optional)
OPENAI_API_KEY=sk-your-openai-key-here
OPENAI_DEFAULT_MODEL=gpt-4-turbo-preview
OPENAI_ORGANIZATION_ID=your-org-id

# LLM Caching
LLM_CACHE_TTL_HOURS=24
LLM_MAX_RETRIES=3

# ============================================================================
# VECTOR DATABASE (RAG)
# ============================================================================
CHROMA_HOST=localhost
CHROMA_PORT=8001
CHROMA_COLLECTION_SSOT=mbi_ssot
EMBEDDING_MODEL=BAAI/bge-m3  # Multilingual embeddings

# ============================================================================
# AD PLATFORMS
# ============================================================================
# Meta (Facebook/Instagram)
META_APP_ID=your-meta-app-id
META_APP_SECRET=your-meta-app-secret
META_ACCESS_TOKEN=your-long-lived-access-token
META_AD_ACCOUNT_ID=act_1234567890

# Google Ads
GOOGLE_ADS_DEVELOPER_TOKEN=your-developer-token
GOOGLE_ADS_CLIENT_ID=your-client-id
GOOGLE_ADS_CLIENT_SECRET=your-client-secret
GOOGLE_ADS_REFRESH_TOKEN=your-refresh-token
GOOGLE_ADS_CUSTOMER_ID=123-456-7890

# TikTok Ads
TIKTOK_ACCESS_TOKEN=your-tiktok-access-token
TIKTOK_ADVERTISER_ID=your-advertiser-id

# YouTube Ads (via Google Ads)
YOUTUBE_ADS_ENABLED=true

# ============================================================================
# ANALYTICS
# ============================================================================
# Google Analytics 4
GA4_PROPERTY_ID=your-ga4-property-id
GA4_CREDENTIALS_PATH=./config/ga4-credentials.json

# ============================================================================
# E-COMMERCE
# ============================================================================
# Shopify
SHOPIFY_SHOP_NAME=your-store.myshopify.com
SHOPIFY_ACCESS_TOKEN=shpat_your-access-token
SHOPIFY_API_VERSION=2024-01
SHOPIFY_WEBHOOK_SECRET=your-webhook-secret

# WooCommerce (Optional)
WOOCOMMERCE_URL=https://your-store.com
WOOCOMMERCE_CONSUMER_KEY=ck_your-consumer-key
WOOCOMMERCE_CONSUMER_SECRET=cs_your-consumer-secret

# ============================================================================
# SOCIAL LISTENING
# ============================================================================
# Twitter/X API
TWITTER_BEARER_TOKEN=your-twitter-bearer-token
TWITTER_API_KEY=your-api-key
TWITTER_API_SECRET=your-api-secret

# Reddit API
REDDIT_CLIENT_ID=your-client-id
REDDIT_CLIENT_SECRET=your-client-secret
REDDIT_USER_AGENT=MBI/1.0

# ============================================================================
# WORKFLOW ORCHESTRATION
# ============================================================================
# Prefect
PREFECT_API_URL=http://localhost:4200/api
PREFECT_API_KEY=your-prefect-api-key

# Celery
CELERY_BROKER_URL=redis://localhost:6379/2
CELERY_RESULT_BACKEND=redis://localhost:6379/3

# ============================================================================
# MONITORING & OBSERVABILITY
# ============================================================================
# Prometheus
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090

# Sentry (Error Tracking)
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1

# OpenTelemetry
OTEL_ENABLED=true
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317
OTEL_SERVICE_NAME=mbi-backend

# ============================================================================
# AUTHENTICATION & AUTHORIZATION
# ============================================================================
# JWT Settings
JWT_SECRET_KEY=your-jwt-secret-key-change-in-production
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=60
JWT_REFRESH_TOKEN_EXPIRE_DAYS=30

# OAuth2 (Optional)
OAUTH2_GOOGLE_CLIENT_ID=your-google-client-id
OAUTH2_GOOGLE_CLIENT_SECRET=your-google-client-secret

# ============================================================================
# EMAIL
# ============================================================================
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_FROM_EMAIL=noreply@company.com
SMTP_FROM_NAME=MBI System

# ============================================================================
# NOTIFICATIONS
# ============================================================================
# Slack
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
SLACK_ALERT_CHANNEL=#mbi-alerts
SLACK_BOT_TOKEN=xoxb-your-bot-token

# PagerDuty
PAGERDUTY_API_KEY=your-pagerduty-api-key
PAGERDUTY_SERVICE_ID=your-service-id

# ============================================================================
# FEATURE FLAGS
# ============================================================================
FEATURE_MMM_ENABLED=true
FEATURE_MTA_ENABLED=true
FEATURE_LLM_ENABLED=true
FEATURE_CRISIS_DETECTION_ENABLED=true
FEATURE_CREATIVE_GENERATION_ENABLED=true
FEATURE_AUTO_BUDGET_ALLOCATION=false  # Requires approval in MVP
FEATURE_AUTO_CREATIVE_ROTATION=true

# ============================================================================
# RATE LIMITING
# ============================================================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_MINUTE=100
RATE_LIMIT_PER_HOUR=1000
RATE_LIMIT_PER_DAY=10000

# ============================================================================
# DATA RETENTION & PRIVACY
# ============================================================================
# GDPR Compliance
PII_HASH_SALT=your-random-salt-for-hashing-pii
DATA_RETENTION_DAYS=90
AUTO_DELETE_ENABLED=true

# User Consent
COOKIE_CONSENT_REQUIRED=true
ANALYTICS_OPT_OUT_ENABLED=true

# ============================================================================
# MODEL SETTINGS
# ============================================================================
# MMM (Marketing Mix Modeling)
MMM_LOOKBACK_WEEKS=52
MMM_RETRAIN_SCHEDULE=weekly
MMM_MIN_DATA_POINTS=13  # Minimum 13 weeks

# MTA (Multi-Touch Attribution)
MTA_LOOKBACK_DAYS=30
MTA_MIN_TOUCHPOINTS=1
MTA_MAX_TOUCHPOINTS=10
MTA_METHOD=markov  # markov, shapley

# Lead Scoring
LEAD_SCORING_MODEL_PATH=./models/lead_scoring_v1.pkl
LEAD_SCORING_THRESHOLD=0.7
LEAD_SCORING_RETRAIN_DAYS=7

# Creative Intelligence
CREATIVE_FATIGUE_THRESHOLD=0.7
CREATIVE_ANALYSIS_BATCH_SIZE=50

# ============================================================================
# BUDGET & CONSTRAINTS
# ============================================================================
DEFAULT_WEEKLY_BUDGET=500000
MIN_CHANNEL_BUDGET_PCT=0.05  # 5% minimum
MAX_CHANNEL_BUDGET_PCT=0.60  # 60% maximum
MAX_BUDGET_SHIFT_PER_WEEK=0.25  # 25% max change

TARGET_ROAS=2.5
TARGET_CAC=5000
TARGET_CAC_CURRENCY=JPY

# ============================================================================
# TESTING
# ============================================================================
TEST_DATABASE_URL=postgresql+asyncpg://mbi_user:mbi_password@localhost:5432/mbi_test
TEST_REDIS_URL=redis://localhost:6379/15
PYTEST_WORKERS=4

# ============================================================================
# DEVELOPMENT
# ============================================================================
# Hot Reload
RELOAD=true
RELOAD_DIRS=./app

# Debug Tools
ENABLE_PROFILER=false
ENABLE_QUERY_LOGGING=false

# Sample Data Generation
GENERATE_SAMPLE_DATA=true
SAMPLE_DATA_SIZE=1000

# ============================================================================
# FRONTEND
# ============================================================================
NEXT_PUBLIC_API_URL=http://localhost:8000/api/v2
NEXT_PUBLIC_WS_URL=ws://localhost:8000/ws
NEXT_PUBLIC_ENV=development
